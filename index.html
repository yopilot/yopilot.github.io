<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>P2P Screen Share - PeerJS</title>
    <!-- PeerJS CDN -->
    <script src="https://unpkg.com/peerjs@1.5.5/dist/peerjs.min.js"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🖥️ P2P Screen Share</h1>
            <p class="subtitle">Share your screen with friends - Powered by PeerJS!</p>
        </header>

        <div class="connection-panel">
            <div class="id-section">
                <label>Your Peer ID:</label>
                <div class="id-display">
                    <input type="text" id="myId" readonly>
                    <button id="copyId" title="Copy ID">📋</button>
                </div>
            </div>

            <div class="workflow-buttons">
                <button id="startConnectionBtn" class="workflow-btn">
                    <span class="icon">📤</span>
                    <div>
                        <strong>Connect to Friend</strong>
                        <small>Enter your friend's ID to connect</small>
                    </div>
                </button>
                <button id="receiveConnectionBtn" class="workflow-btn">
                    <span class="icon">📥</span>
                    <div>
                        <strong>Receive Connection</strong>
                        <small>Share your ID with friend</small>
                    </div>
                </button>
            </div>
        </div>

        <div class="controls">
            <button id="shareScreen" disabled>
                <span class="icon">🖥️</span>
                <span>Share Screen</span>
            </button>
            <button id="stopShare" disabled>
                <span class="icon">⏹️</span>
                <span>Stop Sharing</span>
            </button>
            <label class="toggle" style="margin-left: 20px;">
                <input type="checkbox" id="videoToggle">
                <span class="slider"></span>
                <span class="label">📹 Camera</span>
            </label>
        </div>

        <div class="status-bar">
            <span id="connectionStatus" class="status disconnected">⚪ Not Connected</span>
            <span id="streamStatus" class="status">⚪ Not Sharing</span>
        </div>

        <!-- P2P Chat Panel -->
        <div class="chat-panel" style="display: none;" id="chatPanel">
            <div class="chat-header">
                <h3>💬 P2P Chat</h3>
                <button id="toggleChat" class="minimize-btn">_</button>
            </div>
            <div class="chat-messages" id="chatMessages"></div>
            <div class="chat-input-area">
                <input type="text" id="chatInput" placeholder="Type a message..." />
                <button id="sendMessage">Send</button>
            </div>
        </div>

        <div class="video-container" id="videoContainer">
            <div class="video-wrapper local-video hidden" id="localScreenWrapper" data-stream-type="screen-local">
                <video id="localScreen" autoplay muted playsinline></video>
                <span class="video-label">Your Screen Share</span>
                <div class="pip-controls">
                    <button class="pip-btn" onclick="app.toggleMinimize('localScreenWrapper')">−</button>
                </div>
                <button class="fullscreen-btn" onclick="app.toggleFullscreen('localScreenWrapper')">⛶</button>
                <div class="resize-handle corner resize-se"></div>
                <div class="resize-handle corner resize-sw"></div>
                <div class="resize-handle corner resize-ne"></div>
                <div class="resize-handle corner resize-nw"></div>
                <div class="resize-handle edge resize-e"></div>
                <div class="resize-handle edge resize-w"></div>
                <div class="resize-handle edge resize-n"></div>
                <div class="resize-handle edge resize-s"></div>
            </div>
            <div class="video-wrapper remote-video hidden" id="remoteScreenWrapper" data-stream-type="screen-remote">
                <video id="remoteScreen" autoplay playsinline></video>
                <span class="video-label">Friend's Screen Share</span>
                <div class="pip-controls">
                    <button class="pip-btn" onclick="app.toggleMinimize('remoteScreenWrapper')">−</button>
                </div>
                <button class="fullscreen-btn" onclick="app.toggleFullscreen('remoteScreenWrapper')">⛶</button>
                <div class="resize-handle corner resize-se"></div>
                <div class="resize-handle corner resize-sw"></div>
                <div class="resize-handle corner resize-ne"></div>
                <div class="resize-handle corner resize-nw"></div>
                <div class="resize-handle edge resize-e"></div>
                <div class="resize-handle edge resize-w"></div>
                <div class="resize-handle edge resize-n"></div>
                <div class="resize-handle edge resize-s"></div>
            </div>
            <div class="video-wrapper local-video hidden" id="localVideoWrapper" data-stream-type="video-local">
                <video id="localVideo" autoplay muted playsinline></video>
                <span class="video-label">Your Video Call</span>
                <div class="pip-controls">
                    <button class="pip-btn" onclick="app.toggleMinimize('localVideoWrapper')">−</button>
                </div>
                <button class="fullscreen-btn" onclick="app.toggleFullscreen('localVideoWrapper')">⛶</button>
                <div class="resize-handle corner resize-se"></div>
                <div class="resize-handle corner resize-sw"></div>
                <div class="resize-handle corner resize-ne"></div>
                <div class="resize-handle corner resize-nw"></div>
                <div class="resize-handle edge resize-e"></div>
                <div class="resize-handle edge resize-w"></div>
                <div class="resize-handle edge resize-n"></div>
                <div class="resize-handle edge resize-s"></div>
            </div>
            <div class="video-wrapper remote-video hidden" id="remoteVideoWrapper" data-stream-type="video-remote">
                <video id="remoteVideo" autoplay playsinline></video>
                <span class="video-label">Friend's Video Call</span>
                <div class="pip-controls">
                    <button class="pip-btn" onclick="app.toggleMinimize('remoteVideoWrapper')">−</button>
                </div>
                <button class="fullscreen-btn" onclick="app.toggleFullscreen('remoteVideoWrapper')">⛶</button>
                <div class="resize-handle corner resize-se"></div>
                <div class="resize-handle corner resize-sw"></div>
                <div class="resize-handle corner resize-ne"></div>
                <div class="resize-handle corner resize-nw"></div>
                <div class="resize-handle edge resize-e"></div>
                <div class="resize-handle edge resize-w"></div>
                <div class="resize-handle edge resize-n"></div>
                <div class="resize-handle edge resize-s"></div>
            </div>
        </div>

        <div class="instructions">
            <h3>How to use:</h3>
            <ol>
                <li>Wait for your Peer ID to appear (automatically generated)</li>
                <li>Share your ID with your friend</li>
                <li>Click "Connect to Friend" and enter their ID</li>
                <li>Once connected, choose: "Share Screen" OR "Start Video Call"</li>
                <li>Use P2P chat to message directly (no server!)</li>
            </ol>
            <p class="note">✨ PeerJS handles all the complex signaling - 99% connection success rate!</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>